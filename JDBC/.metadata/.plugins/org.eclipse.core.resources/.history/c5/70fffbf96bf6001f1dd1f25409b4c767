package homework;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class SchoolOperation {

    String URL = "jdbc:postgresql://localhost:5432/demo";
    String USER = "postgres";
    String PASSWORD = "pankaj123";

    public static void main(String[] args) {
        SchoolOperation schoolOperation = new SchoolOperation();

        // Create a new student
        schoolOperation.createStudent("pankaj", 334323.0, 86678567864L);

//        // Read all students
//        schoolOperation.readStudents();
//
//        // Update a student's details (update student with id = 1)
//        schoolOperation.updateStudent(1, "pankaj updated", 500000.0, 9876543210L);
//
//        // Read all students after update
//        schoolOperation.readStudents();
//
//        // Delete a student (delete student with id = 1)
//        schoolOperation.deleteStudent(1);
//
//        // Read all students after deletion
//        schoolOperation.readStudents();
    }

    // Method to create a new student
    public void createStudent(String name, double fees, Long phn) {
        String sql = "INSERT INTO student (name, fees, phn) VALUES (?, ?, ?)";

        try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD);
             PreparedStatement pstmt = conn.prepareStatement(sql)) {

            pstmt.setString(1, name);
            pstmt.setDouble(2, fees);
            pstmt.setLong(3, phn);
            pstmt.executeUpdate();
            System.out.println("Student created successfully!");

        } catch (SQLException e) {
            System.out.println("Error creating student: " + e.getMessage());
        }
    }

    // Method to read all students
//    public void readStudents() {
//        String sql = "SELECT * FROM student";
//
//        try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD);
//             PreparedStatement pstmt = conn.prepareStatement(sql);
//             ResultSet rs = pstmt.executeQuery()) {
//
//            System.out.println("\nList of Students:");
//            while (rs.next()) {
//                long id = rs.getLong("id");
//                String name = rs.getString("name");
//                double fees = rs.getDouble("fees");
//                long phn = rs.getLong("phn");
//
//                System.out.println("ID: " + id + ", Name: " + name + ", Fees: " + fees + ", Phone: " + phn);
//            }
//
//        } catch (SQLException e) {
//            System.out.println("Error reading students: " + e.getMessage());
//        }
//    }
//
//    // Method to update a student's details
//    public void updateStudent(long id, String name, double fees, Long phn) {
//        String sql = "UPDATE student SET name = ?, fees = ?, phn = ? WHERE id = ?";
//
//        try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD);
//             PreparedStatement pstmt = conn.prepareStatement(sql)) {
//
//            pstmt.setString(1, name);
//            pstmt.setDouble(2, fees);
//            pstmt.setLong(3, phn);
//            pstmt.setLong(4, id);
//
//            int rowsUpdated = pstmt.executeUpdate();
//
//            if (rowsUpdated > 0) {
//                System.out.println("Student updated successfully!");
//            } else {
//                System.out.println("No student found with ID: " + id);
//            }
//
//        } catch (SQLException e) {
//            System.out.println("Error updating student: " + e.getMessage());
//        }
//    }
//
//    // Method to delete a student
//    public void deleteStudent(long id) {
//        String sql = "DELETE FROM student WHERE id = ?";
//
//        try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD);
//             PreparedStatement pstmt = conn.prepareStatement(sql)) {
//
//            pstmt.setLong(1, id);
//            int rowsDeleted = pstmt.executeUpdate();
//
//            if (rowsDeleted > 0) {
//                System.out.println("Student deleted successfully!");
//            } else {
//                System.out.println("No student found with ID: " + id);
//            }
//
//        } catch (SQLException e) {
//            System.out.println("Error deleting student: " + e.getMessage());
//        }
//    }
}